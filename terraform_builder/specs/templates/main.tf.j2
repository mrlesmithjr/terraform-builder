# Generated using https://github.com/mrlesmithjr/terraform-builder
{%- if module == 'root' %}
{%-   for provider, config in args.providers.items() %}
{%-     if config != {} %}
# Provider {{ provider }} config
provider "{{ provider|lower }}" {
{%-       if provider|lower == 'azurerm' %}
    environment     = var.azurerm_environment
    features        = var.azurerm_features
    subscription_id = var.azurerm_subscription_id
    tenant_id       = var.azurerm_tenant_id
{%-       elif provider|lower == 'digitalocean' %}
    api_endpoint = var.do_api_endpoint
    token        = var.do_token
{%-       elif provider|lower == 'vsphere' %}
    allow_unverified_ssl = var.vsphere_allow_unverified_ssl
    password = var.vsphere_password
    user = var.vsphere_username
    vsphere_server = var.vsphere_server
{%-       endif %}
}
{%-     endif -%}
{%-   endfor %}
{%-   for environment in args.environments %}
# Module {{ environment }} config
module "{{ environment }}" {
    source = "./environments/{{ environment }}"
}
{%-   endfor %}
# Setting required Terraform version or greater
terraform {
  required_version = ">= 0.12"
}
{%- elif module in args.environments %}
{%-   for module in args.modules %}
{%-      if module != 'root' %}
# Module {{ module }} config
module "{{ module }}" {
    source = "../../modules/{{ module }}"
}
{%-      endif %}
{%-    endfor -%}
{% endif %}